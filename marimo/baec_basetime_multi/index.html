<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="./favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" href="./assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" href="./assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" href="./assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" href="./apple-touch-icon.png" />
    <link rel="manifest" href="./manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        resizeObserver.observe(obj.contentWindow.document.body);
      }
    </script>
    <marimo-filename hidden>notebook.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>BAEC</title>
    <script type="module" crossorigin src="./assets/index-CPVCa2dz.js"></script>
    <link rel="stylesheet" crossorigin href="./assets/index-BlxPam9h.css">
  <marimo-wasm hidden=""></marimo-wasm>
    <script>
        if (window.location.protocol === 'file:') {
            alert('Warning: This file must be served by an HTTP server to function correctly.');
        }
    </script>
    
    <style>
        #save-button {
            display: none !important;
        }
        #filename-input {
            display: none !important;
        }
    </style>
    <marimo-code hidden="">import%20marimo%0A%0A__generated_with%20%3D%20%220.14.17%22%0Aapp%20%3D%20marimo.App(%0A%20%20%20%20width%3D%22medium%22%2C%0A%20%20%20%20app_title%3D%22BAEC%22%2C%0A%20%20%20%20layout_file%3D%22data%3Aapplication%2Fjson%3Bbase64%2CewogICJ0eXBlIjogImdyaWQiLAogICJkYXRhIjogewogICAgImNvbHVtbnMiOiAyNCwKICAgICJyb3dIZWlnaHQiOiAyMCwKICAgICJtYXhXaWR0aCI6IDE0MDAsCiAgICAiYm9yZGVyZWQiOiB0cnVlLAogICAgImNlbGxzIjogWwogICAgICB7CiAgICAgICAgInBvc2l0aW9uIjogbnVsbAogICAgICB9LAogICAgICB7CiAgICAgICAgInBvc2l0aW9uIjogbnVsbAogICAgICB9LAogICAgICB7CiAgICAgICAgInBvc2l0aW9uIjogWwogICAgICAgICAgMSwKICAgICAgICAgIDEsCiAgICAgICAgICA4LAogICAgICAgICAgMwogICAgICAgIF0KICAgICAgfSwKICAgICAgewogICAgICAgICJwb3NpdGlvbiI6IG51bGwKICAgICAgfSwKICAgICAgewogICAgICAgICJwb3NpdGlvbiI6IFsKICAgICAgICAgIDE1LAogICAgICAgICAgMSwKICAgICAgICAgIDcsCiAgICAgICAgICAzCiAgICAgICAgXQogICAgICB9LAogICAgICB7CiAgICAgICAgInBvc2l0aW9uIjogWwogICAgICAgICAgMTQsCiAgICAgICAgICA1LAogICAgICAgICAgOSwKICAgICAgICAgIDMKICAgICAgICBdCiAgICAgIH0sCiAgICAgIHsKICAgICAgICAicG9zaXRpb24iOiBudWxsCiAgICAgIH0sCiAgICAgIHsKICAgICAgICAicG9zaXRpb24iOiBudWxsCiAgICAgIH0sCiAgICAgIHsKICAgICAgICAicG9zaXRpb24iOiBbCiAgICAgICAgICAxLAogICAgICAgICAgOSwKICAgICAgICAgIDcsCiAgICAgICAgICAzCiAgICAgICAgXQogICAgICB9LAogICAgICB7CiAgICAgICAgInBvc2l0aW9uIjogWwogICAgICAgICAgOSwKICAgICAgICAgIDksCiAgICAgICAgICA3LAogICAgICAgICAgMwogICAgICAgIF0sCiAgICAgICAgInNpZGUiOiAibGVmdCIKICAgICAgfSwKICAgICAgewogICAgICAgICJwb3NpdGlvbiI6IG51bGwKICAgICAgfSwKICAgICAgewogICAgICAgICJwb3NpdGlvbiI6IG51bGwKICAgICAgfSwKICAgICAgewogICAgICAgICJwb3NpdGlvbiI6IFsKICAgICAgICAgIDEsCiAgICAgICAgICAxMiwKICAgICAgICAgIDIyLAogICAgICAgICAgMzAKICAgICAgICBdCiAgICAgIH0sCiAgICAgIHsKICAgICAgICAicG9zaXRpb24iOiBbCiAgICAgICAgICAxNywKICAgICAgICAgIDksCiAgICAgICAgICA2LAogICAgICAgICAgMwogICAgICAgIF0sCiAgICAgICAgInNpZGUiOiAibGVmdCIKICAgICAgfSwKICAgICAgewogICAgICAgICJwb3NpdGlvbiI6IFsKICAgICAgICAgIDEsCiAgICAgICAgICA0MiwKICAgICAgICAgIDIyLAogICAgICAgICAgMTkKICAgICAgICBdCiAgICAgIH0sCiAgICAgIHsKICAgICAgICAicG9zaXRpb24iOiBbCiAgICAgICAgICAxLAogICAgICAgICAgNjEsCiAgICAgICAgICAyMiwKICAgICAgICAgIDE4CiAgICAgICAgXQogICAgICB9LAogICAgICB7CiAgICAgICAgInBvc2l0aW9uIjogWwogICAgICAgICAgMTcsCiAgICAgICAgICA3OSwKICAgICAgICAgIDYsCiAgICAgICAgICAzCiAgICAgICAgXSwKICAgICAgICAic2lkZSI6ICJyaWdodCIKICAgICAgfSwKICAgICAgewogICAgICAgICJwb3NpdGlvbiI6IG51bGwKICAgICAgfSwKICAgICAgewogICAgICAgICJwb3NpdGlvbiI6IFsKICAgICAgICAgIDEsCiAgICAgICAgICA3OSwKICAgICAgICAgIDcsCiAgICAgICAgICAzCiAgICAgICAgXQogICAgICB9LAogICAgICB7CiAgICAgICAgInBvc2l0aW9uIjogWwogICAgICAgICAgMSwKICAgICAgICAgIDgyLAogICAgICAgICAgNywKICAgICAgICAgIDMKICAgICAgICBdCiAgICAgIH0sCiAgICAgIHsKICAgICAgICAicG9zaXRpb24iOiBbCiAgICAgICAgICAxLAogICAgICAgICAgODgsCiAgICAgICAgICA3LAogICAgICAgICAgMwogICAgICAgIF0KICAgICAgfSwKICAgICAgewogICAgICAgICJwb3NpdGlvbiI6IFsKICAgICAgICAgIDEsCiAgICAgICAgICA4NSwKICAgICAgICAgIDcsCiAgICAgICAgICAzCiAgICAgICAgXQogICAgICB9LAogICAgICB7CiAgICAgICAgInBvc2l0aW9uIjogbnVsbAogICAgICB9LAogICAgICB7CiAgICAgICAgInBvc2l0aW9uIjogbnVsbAogICAgICB9LAogICAgICB7CiAgICAgICAgInBvc2l0aW9uIjogWwogICAgICAgICAgMSwKICAgICAgICAgIDkxLAogICAgICAgICAgMjIsCiAgICAgICAgICAxMwogICAgICAgIF0KICAgICAgfSwKICAgICAgewogICAgICAgICJwb3NpdGlvbiI6IG51bGwKICAgICAgfSwKICAgICAgewogICAgICAgICJwb3NpdGlvbiI6IFsKICAgICAgICAgIDEsCiAgICAgICAgICAxMDQsCiAgICAgICAgICAyMiwKICAgICAgICAgIDIzCiAgICAgICAgXQogICAgICB9LAogICAgICB7CiAgICAgICAgInBvc2l0aW9uIjogbnVsbAogICAgICB9CiAgICBdCiAgfQp9%22%2C%0A)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20datetime%0A%20%20%20%20import%20os%0A%20%20%20%20import%20sys%0A%0A%20%20%20%20import%20altair%20as%20alt%0A%20%20%20%20import%20geopandas%20as%20gpd%0A%20%20%20%20import%20leafmap.foliumap%20as%20leafmap%0A%20%20%20%20import%20micropip%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20import%20shapely%20as%20shp%0A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20return%20alt%2C%20datetime%2C%20gpd%2C%20leafmap%2C%20micropip%2C%20mo%2C%20np%2C%20os%2C%20pd%2C%20shp%2C%20sys%0A%0A%0A%40app.cell%0Aasync%20def%20_(micropip%2C%20sys)%3A%0A%20%20%20%20if%20sys.platform%20%3D%3D%20%22emscripten%22%3A%0A%20%20%20%20%20%20%20%20%23%20running%20in%20Pyodide%20or%20other%20Emscripten%20based%20build%0A%20%20%20%20%20%20%20%20await%20micropip.install(%5B%22pyodide-http%22%2C%20%22baec%5Baws%5D%22%2C%20%22ssl%22%5D)%0A%0A%20%20%20%20%20%20%20%20%23%20Patch%20requests%0A%20%20%20%20%20%20%20%20import%20pyodide_http%0A%0A%20%20%20%20%20%20%20%20pyodide_http.patch_all()%0A%0A%20%20%20%20from%20nuclei.client%20import%20NucleiClient%0A%0A%20%20%20%20from%20baec.measurements.io.basetime%20import%20BaseTimeBucket%2C%20Credentials%0A%20%20%20%20from%20baec.measurements.measured_settlement_series%20import%20(%0A%20%20%20%20%20%20%20%20MeasuredSettlementSeries%2C%0A%20%20%20%20)%0A%20%20%20%20from%20baec.model.fitcore%20import%20(%0A%20%20%20%20%20%20%20%20FitCoreModel%2C%0A%20%20%20%20%20%20%20%20FitCoreModelGenerator%2C%0A%20%20%20%20%20%20%20%20FitCoreParameters%2C%0A%20%20%20%20%20%20%20%20FitCoreParametersBounds%2C%0A%20%20%20%20)%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20BaseTimeBucket%2C%0A%20%20%20%20%20%20%20%20Credentials%2C%0A%20%20%20%20%20%20%20%20FitCoreModelGenerator%2C%0A%20%20%20%20%20%20%20%20FitCoreParameters%2C%0A%20%20%20%20%20%20%20%20FitCoreParametersBounds%2C%0A%20%20%20%20%20%20%20%20MeasuredSettlementSeries%2C%0A%20%20%20%20%20%20%20%20NucleiClient%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20jwt%20%3D%20mo.ui.text(placeholder%3D%22%22%2C%20label%3D%22NUCLEI%20JWT%22%2C%20kind%3D%22password%22)%0A%20%20%20%20jwt%0A%20%20%20%20return%20(jwt%2C)%0A%0A%0A%40app.cell%0Adef%20_(NucleiClient%2C%20jwt%2C%20os)%3A%0A%20%20%20%20if%20jwt.value%20!%3D%20%22%22%3A%0A%20%20%20%20%20%20%20%20os.environ%5B%22NUCLEI_TOKEN%22%5D%20%3D%20jwt.value%0A%0A%20%20%20%20if%20%22NUCLEI_TOKEN%22%20in%20os.environ%3A%0A%20%20%20%20%20%20%20%20client%20%3D%20NucleiClient()%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20raise%20ValueError(%22No%20JWT%20token%20provided%22)%0A%20%20%20%20return%20(client%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20aws_access_key_id%20%3D%20mo.ui.text(%0A%20%20%20%20%20%20%20%20placeholder%3D%22%22%2C%20label%3D%22BaseTime%20key%20ID%22%2C%20kind%3D%22text%22%0A%20%20%20%20)%0A%20%20%20%20aws_access_key_id%0A%20%20%20%20return%20(aws_access_key_id%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20aws_secret_access_key%20%3D%20mo.ui.text(%0A%20%20%20%20%20%20%20%20placeholder%3D%22%22%2C%20label%3D%22BaseTime%20key%20password%22%2C%20kind%3D%22password%22%0A%20%20%20%20)%0A%20%20%20%20aws_secret_access_key%0A%20%20%20%20return%20(aws_secret_access_key%2C)%0A%0A%0A%40app.cell%0Adef%20_(Credentials%2C%20aws_access_key_id%2C%20aws_secret_access_key%2C%20os)%3A%0A%20%20%20%20if%20aws_access_key_id.value%20!%3D%20%22%22%3A%0A%20%20%20%20%20%20%20%20os.environ%5B%22BASETIME_KEY_ID%22%5D%20%3D%20aws_access_key_id.value%0A%0A%20%20%20%20if%20aws_secret_access_key.value%20!%3D%20%22%22%3A%0A%20%20%20%20%20%20%20%20os.environ%5B%22BASETIME_ACCESS_KEY%22%5D%20%3D%20aws_secret_access_key.value%0A%0A%20%20%20%20if%20%22BASETIME_KEY_ID%22%20in%20os.environ%20and%20%22BASETIME_ACCESS_KEY%22%20in%20os.environ%3A%0A%20%20%20%20%20%20%20%20credentials%20%3D%20Credentials()%0A%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20raise%20ValueError(%22BaseTime%20AWS%20credentials%20provided%22)%0A%20%20%20%20return%20(credentials%2C)%0A%0A%0A%40app.cell%0Adef%20_(BaseTimeBucket%2C%20credentials)%3A%0A%20%20%20%20%23%20create%20bucket%20manager%0A%20%20%20%20manage_project%20%3D%20BaseTimeBucket(credentials)%0A%0A%20%20%20%20%23%20get%20all%20the%20rod_id%20available%20to%20the%20user%0A%20%20%20%20projects_ids%20%3D%20manage_project.get_users_projects_ids()%0A%20%20%20%20return%20manage_project%2C%20projects_ids%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20projects_ids)%3A%0A%20%20%20%20%23%20With%20search%20functionality%0A%20%20%20%20_options%20%3D%20sorted(list(projects_ids.keys()))%0A%20%20%20%20project%20%3D%20mo.ui.dropdown(%0A%20%20%20%20%20%20%20%20options%3D_options%2C%0A%20%20%20%20%20%20%20%20value%3D_options%5B0%5D%2C%0A%20%20%20%20%20%20%20%20label%3D%22Project%20name%22%2C%0A%20%20%20%20%20%20%20%20searchable%3DTrue%2C%0A%20%20%20%20%20%20%20%20allow_select_none%3DFalse%2C%0A%20%20%20%20)%0A%20%20%20%20project%0A%20%20%20%20return%20(project%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20project%2C%20projects_ids)%3A%0A%20%20%20%20%23%20With%20search%20functionality%0A%20%20%20%20_options%20%3D%20sorted(projects_ids%5Bproject.value%5D)%0A%20%20%20%20rod_id%20%3D%20mo.ui.multiselect(%0A%20%20%20%20%20%20%20%20options%3D_options%2C%0A%20%20%20%20%20%20%20%20value%3D%5B_options%5B0%5D%5D%2C%0A%20%20%20%20%20%20%20%20label%3D%22Settlement%20rod%22%2C%0A%20%20%20%20)%0A%20%20%20%20rod_id%0A%20%20%20%20return%20(rod_id%2C)%0A%0A%0A%40app.cell%0Adef%20_(manage_project%2C%20mo%2C%20np%2C%20pd%2C%20project%2C%20rod_id)%3A%0A%20%20%20%20measurements_list%20%3D%20%5B%5D%0A%20%20%20%20_measurements_db_list%20%3D%20%5B%5D%0A%20%20%20%20_records%20%3D%20%5B%5D%0A%20%20%20%20for%20_id%20in%20mo.status.progress_bar(%0A%20%20%20%20%20%20%20%20rod_id.value%2C%0A%20%20%20%20%20%20%20%20title%3D%22Loading%22%2C%0A%20%20%20%20%20%20%20%20subtitle%3D%22Please%20wait%22%2C%0A%20%20%20%20%20%20%20%20show_eta%3DTrue%2C%0A%20%20%20%20%20%20%20%20show_rate%3DTrue%2C%0A%20%20%20%20)%3A%0A%20%20%20%20%20%20%20%20%23%20create%20settlement%20rod%20measurement%20series%20from%20BaseTime%20Bucket%0A%20%20%20%20%20%20%20%20_series%20%3D%20manage_project.make_settlement_rod_measurement_series(%0A%20%20%20%20%20%20%20%20%20%20%20%20project%3Dproject.value%2C%20rod_id%3D_id%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20_series_df%20%3D%20_series.to_dataframe()%0A%0A%20%20%20%20%20%20%20%20_records.append(%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22SettlementRod%22%3A%20_id%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22x%22%3A%20_series_df%5B%22rod_top_x%22%5D.iloc%5B-1%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22y%22%3A%20_series_df%5B%22rod_top_y%22%5D.iloc%5B-1%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Time%3Bmin%22%3A%20_series_df%5B%22date_time%22%5D.iloc%5B0%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Time%3Bmax%22%3A%20_series_df%5B%22date_time%22%5D.iloc%5B-1%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Duration%22%3A%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_series_df%5B%22date_time%22%5D.iloc%5B-1%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20_series_df%5B%22date_time%22%5D.iloc%5B0%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20).days%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Number%20of%20measurements%22%3A%20len(_series_df)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22SurfaceLevel%3Bmax%22%3A%20_series_df%5B%22ground_surface_z%22%5D.iloc%5B-1%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22SurfaceElevation%3Bmax%22%3A%20_series_df%5B%22ground_surface_z%22%5D.iloc%5B-1%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20_series_df%5B%22ground_surface_z%22%5D.iloc%5B0%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Settlement%3Bmax%22%3A%20_series_df%5B%22rod_bottom_z%22%5D.iloc%5B-1%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22SettlementElevation%3Bmax%22%3A%20_series_df%5B%22rod_bottom_z%22%5D.iloc%5B-1%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20_series_df%5B%22rod_bottom_z%22%5D.iloc%5B0%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20_series_df%20%3D%20_series_df.set_index(%22date_time%22%2C%20drop%3DFalse)%0A%20%20%20%20%20%20%20%20_series_df%20%3D%20_series_df.resample(%221W%22).max()%0A%0A%20%20%20%20%20%20%20%20if%20not%20all(np.isnan(_series_df%5B%22rod_bottom_z%22%5D))%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20measurements_list.append(_series)%0A%20%20%20%20%20%20%20%20%20%20%20%20_measurements_db_list.append(_series_df)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%3Awarning%3A%20No%20measurements%20for%20%7B_id%7D%22)%0A%0A%20%20%20%20measurements_db%20%3D%20pd.concat(_measurements_db_list)%0A%20%20%20%20measurements_df%20%3D%20pd.DataFrame(_records)%0A%20%20%20%20return%20measurements_db%2C%20measurements_list%0A%0A%0A%40app.cell%0Adef%20_(gpd%2C%20measurements_db%2C%20shp)%3A%0A%20%20%20%20measurements_db%5B%22geometry%22%5D%20%3D%20measurements_db%5B%0A%20%20%20%20%20%20%20%20%5B%22rod_top_x%22%2C%20%22rod_top_y%22%5D%0A%20%20%20%20%5D.apply(lambda%20x%3A%20shp.Point(*x)%2C%20axis%3D1)%0A%20%20%20%20measurements_gdf%20%3D%20gpd.GeoDataFrame(%0A%20%20%20%20%20%20%20%20measurements_db%2C%20geometry%3D%22geometry%22%2C%20crs%3D%22epsg%3A28992%22%0A%20%20%20%20).to_crs(%22WGS84%22)%0A%20%20%20%20return%20(measurements_gdf%2C)%0A%0A%0A%40app.cell%0Adef%20_(leafmap%2C%20measurements_gdf)%3A%0A%20%20%20%20m%20%3D%20leafmap.Map(%0A%20%20%20%20%20%20%20%20tiles%3D%22CartoDB%20Positron%22%2C%0A%20%20%20%20%20%20%20%20measure_control%3DFalse%2C%0A%20%20%20%20%20%20%20%20draw_control%3DFalse%2C%0A%20%20%20%20%20%20%20%20center%3D(52.4%2C%204.9)%2C%0A%20%20%20%20%20%20%20%20zoom%3D9%2C%0A%20%20%20%20)%0A%20%20%20%20m.add_gdf(measurements_gdf%2C%20layer_name%3D%22Measurements%22)%0A%20%20%20%20m%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(measurements_db%2C%20mo)%3A%0A%20%20%20%20start_date_time%20%3D%20mo.ui.date.from_series(%0A%20%20%20%20%20%20%20%20measurements_db%5B%22date_time%22%5D%2C%20label%3D%22Start%20date%22%0A%20%20%20%20)%0A%20%20%20%20start_date_time%0A%20%20%20%20return%20(start_date_time%2C)%0A%0A%0A%40app.cell%0Adef%20_(alt%2C%20measurements_db%2C%20pd%2C%20start_date_time)%3A%0A%20%20%20%20_chart_1%20%3D%20(%0A%20%20%20%20%20%20%20%20alt.Chart(measurements_db)%0A%20%20%20%20%20%20%20%20.mark_line()%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3Dalt.X(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20field%3D%22date_time%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20type%3D%22temporal%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20timeUnit%3D%22yearmonthdate%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3D%22Date%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y%3Dalt.Y(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20field%3D%22ground_surface_z%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20type%3D%22quantitative%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3D%22Surface%20level%20Measurements%20%5Bm%20NAP%5D%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3Dalt.Color(field%3D%22object_id%22%2C%20type%3D%22nominal%22%2C%20title%3D%22Legend%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tooltip%3D%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20field%3D%22date_time%22%2C%20timeUnit%3D%22yearmonthdate%22%2C%20title%3D%22Date%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20field%3D%22ground_surface_z%22%2C%20format%3D%22%2C.2f%22%2C%20title%3D%22Value%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(field%3D%22object_id%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20)%0A%20%20%20%20_rules%20%3D%20(%0A%20%20%20%20%20%20%20%20alt.Chart(%0A%20%20%20%20%20%20%20%20%20%20%20%20pd.DataFrame(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%22date_time%22%3A%20%5Bstart_date_time.value%5D%2C%20%22color%22%3A%20%5B%22black%22%5D%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.mark_rule()%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3Dalt.X(field%3D%22date_time%22%2C%20type%3D%22temporal%22%2C%20timeUnit%3D%22yearmonthdate%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3Dalt.Color(%22color%3AN%22%2C%20scale%3DNone)%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20)%0A%20%20%20%20(_chart_1%20%2B%20_rules).resolve_scale()%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(alt%2C%20measurements_db%2C%20pd%2C%20start_date_time)%3A%0A%20%20%20%20_chart_1%20%3D%20(%0A%20%20%20%20%20%20%20%20alt.Chart(measurements_db)%0A%20%20%20%20%20%20%20%20.mark_line()%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3Dalt.X(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20field%3D%22date_time%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20type%3D%22temporal%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20timeUnit%3D%22yearmonthdate%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3D%22Date%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y%3Dalt.Y(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20field%3D%22rod_bottom_z%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20type%3D%22quantitative%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3D%22Settlement%20Measurements%20%5Bm%20NAP%5D%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3Dalt.Color(field%3D%22object_id%22%2C%20type%3D%22nominal%22%2C%20title%3D%22Legend%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tooltip%3D%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20field%3D%22date_time%22%2C%20timeUnit%3D%22yearmonthdate%22%2C%20title%3D%22Date%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(field%3D%22rod_bottom_z%22%2C%20format%3D%22%2C.2f%22%2C%20title%3D%22Value%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(field%3D%22object_id%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20)%0A%0A%20%20%20%20_rules%20%3D%20(%0A%20%20%20%20%20%20%20%20alt.Chart(%0A%20%20%20%20%20%20%20%20%20%20%20%20pd.DataFrame(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%22date_time%22%3A%20%5Bstart_date_time.value%5D%2C%20%22color%22%3A%20%5B%22black%22%5D%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.mark_rule()%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3Dalt.X(field%3D%22date_time%22%2C%20type%3D%22temporal%22%2C%20timeUnit%3D%22yearmonthdate%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3Dalt.Color(%22color%3AN%22%2C%20scale%3DNone)%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20)%0A%20%20%20%20(_chart_1%20%2B%20_rules).resolve_scale()%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(measurements_db%2C%20mo)%3A%0A%20%20%20%20csv_download_lazy_measurements%20%3D%20mo.download(%0A%20%20%20%20%20%20%20%20data%3Dmeasurements_db.to_csv(sep%3D%22%3B%22).encode(%22utf-8%22)%2C%0A%20%20%20%20%20%20%20%20filename%3D%22measurements.csv%22%2C%0A%20%20%20%20%20%20%20%20mimetype%3D%22text%2Fcsv%22%2C%0A%20%20%20%20%20%20%20%20label%3D%22Download%20CSV%22%2C%0A%20%20%20%20)%0A%20%20%20%20csv_download_lazy_measurements%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20MeasuredSettlementSeries%2C%0A%20%20%20%20datetime%2C%0A%20%20%20%20measurements_list%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20start_date_time%2C%0A)%3A%0A%20%20%20%20series_list%20%3D%20%5B%5D%0A%20%20%20%20for%20measurement%20in%20mo.status.progress_bar(%0A%20%20%20%20%20%20%20%20measurements_list%2C%0A%20%20%20%20%20%20%20%20title%3D%22Loading%22%2C%0A%20%20%20%20%20%20%20%20subtitle%3D%22Please%20wait%22%2C%0A%20%20%20%20%20%20%20%20show_eta%3DTrue%2C%0A%20%20%20%20%20%20%20%20show_rate%3DTrue%2C%0A%20%20%20%20)%3A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20_series%20%3D%20MeasuredSettlementSeries(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20measurement%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20start_date_time%3Ddatetime.datetime.combine(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20start_date_time.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20measurement.to_dataframe()%5B%22date_time%22%5D.min().time()%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20series_list.append(_series)%0A%20%20%20%20%20%20%20%20except%20ValueError%20as%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22%3Awarning%3A%20%7Bmeasurement.object_id%7D%20provided%20the%20following%20error%3A%20%7Be%7D%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20return%20measurement%2C%20series_list%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20primary_settlement_bounds%20%3D%20mo.ui.range_slider(%0A%20%20%20%20%20%20%20%20start%3D0%2C%0A%20%20%20%20%20%20%20%20stop%3D100%2C%0A%20%20%20%20%20%20%20%20step%3D1%2C%0A%20%20%20%20%20%20%20%20value%3D%5B0%2C%20100%5D%2C%0A%20%20%20%20%20%20%20%20show_value%3DTrue%2C%0A%20%20%20%20%20%20%20%20label%3D%22primary%20settlement%20%5B%25%5D%22%2C%0A%20%20%20%20)%0A%0A%20%20%20%20primary_settlement_bounds%0A%20%20%20%20return%20(primary_settlement_bounds%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20shift_bounds%20%3D%20mo.ui.range_slider(%0A%20%20%20%20%20%20%20%20start%3D0%2C%0A%20%20%20%20%20%20%20%20stop%3D10%2C%0A%20%20%20%20%20%20%20%20step%3D1%2C%0A%20%20%20%20%20%20%20%20value%3D%5B0%2C%20100%5D%2C%0A%20%20%20%20%20%20%20%20show_value%3DTrue%2C%0A%20%20%20%20%20%20%20%20label%3D%22shift%20%5Bdays%5D%22%2C%0A%20%20%20%20)%0A%0A%20%20%20%20shift_bounds%0A%20%20%20%20return%20(shift_bounds%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20hydrodynamic_period_bounds%20%3D%20mo.ui.range_slider(%0A%20%20%20%20%20%20%20%20start%3D0%2C%0A%20%20%20%20%20%20%20%20stop%3D10%2C%0A%20%20%20%20%20%20%20%20step%3D1%2C%0A%20%20%20%20%20%20%20%20value%3D%5B0%2C%206%5D%2C%0A%20%20%20%20%20%20%20%20show_value%3DTrue%2C%0A%20%20%20%20%20%20%20%20label%3D%22hydrodynamic%20period%20%5Byear%5D%22%2C%0A%20%20%20%20)%0A%0A%20%20%20%20hydrodynamic_period_bounds%0A%20%20%20%20return%20(hydrodynamic_period_bounds%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20final_settlement_bounds%20%3D%20mo.ui.range_slider(%0A%20%20%20%20%20%20%20%20start%3D0%2C%0A%20%20%20%20%20%20%20%20stop%3D10%2C%0A%20%20%20%20%20%20%20%20step%3D1%2C%0A%20%20%20%20%20%20%20%20value%3D%5B0%2C%206%5D%2C%0A%20%20%20%20%20%20%20%20show_value%3DTrue%2C%0A%20%20%20%20%20%20%20%20label%3D%22final%20settlement%20%5Bm%5D%22%2C%0A%20%20%20%20)%0A%20%20%20%20final_settlement_bounds%0A%20%20%20%20return%20(final_settlement_bounds%2C)%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20FitCoreModelGenerator%2C%0A%20%20%20%20FitCoreParameters%2C%0A%20%20%20%20FitCoreParametersBounds%2C%0A%20%20%20%20client%2C%0A%20%20%20%20final_settlement_bounds%2C%0A%20%20%20%20hydrodynamic_period_bounds%2C%0A%20%20%20%20measurement%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20primary_settlement_bounds%2C%0A%20%20%20%20series_list%2C%0A%20%20%20%20shift_bounds%2C%0A)%3A%0A%20%20%20%20mo.stop(predicate%3Dlen(series_list)%20%3D%3D%200)%0A%20%20%20%20params%20%3D%20FitCoreParameters(%0A%20%20%20%20%20%20%20%20primarySettlement%3DFitCoreParametersBounds(%0A%20%20%20%20%20%20%20%20%20%20%20%20*primary_settlement_bounds.value%0A%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20shift%3DFitCoreParametersBounds(*shift_bounds.value)%2C%0A%20%20%20%20%20%20%20%20hydrodynamicPeriod%3DFitCoreParametersBounds(%0A%20%20%20%20%20%20%20%20%20%20%20%20*hydrodynamic_period_bounds.value%0A%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20finalSettlement%3DFitCoreParametersBounds(*final_settlement_bounds.value)%2C%0A%20%20%20%20)%0A%0A%20%20%20%20model_list%20%3D%20%5B%5D%0A%20%20%20%20for%20_series%20in%20mo.status.progress_bar(%0A%20%20%20%20%20%20%20%20series_list%2C%0A%20%20%20%20%20%20%20%20title%3D%22Loading%22%2C%0A%20%20%20%20%20%20%20%20subtitle%3D%22Please%20wait%22%2C%0A%20%20%20%20%20%20%20%20show_eta%3DTrue%2C%0A%20%20%20%20%20%20%20%20show_rate%3DTrue%2C%0A%20%20%20%20)%3A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20_model%20%3D%20FitCoreModelGenerator(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20series%3D_series%2C%20client%3Dclient%2C%20model_parameters%3Dparams%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20model_list.append(_model)%0A%20%20%20%20%20%20%20%20except%20ValueError%20as%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22%3Awarning%3A%20%7Bmeasurement.object_id%7D%20provided%20the%20following%20error%3A%20%7Be%7D%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20return%20(model_list%2C)%0A%0A%0A%40app.cell%0Adef%20_(datetime%2C%20measurement%2C%20mo%2C%20model_list%2C%20np%2C%20pd%2C%20start_date_time)%3A%0A%20%20%20%20mo.stop(predicate%3Dlen(model_list)%20%3D%3D%200)%0A%0A%20%20%20%20prediction_db_list%20%3D%20%5B%5D%0A%20%20%20%20_records%20%3D%20%5B%5D%0A%20%20%20%20for%20_model%20in%20mo.status.progress_bar(%0A%20%20%20%20%20%20%20%20model_list%2C%0A%20%20%20%20%20%20%20%20title%3D%22Loading%22%2C%0A%20%20%20%20%20%20%20%20subtitle%3D%22Please%20wait%22%2C%0A%20%20%20%20%20%20%20%20show_eta%3DTrue%2C%0A%20%20%20%20%20%20%20%20show_rate%3DTrue%2C%0A%20%20%20%20)%3A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20days%20%3D%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20np.logspace(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20start%3D0%2C%20stop%3D5%2C%20endpoint%3DTrue%2C%20num%3D100%2C%20dtype%3Dnp.int64%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2B%20_model.model.shift%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20result%20%3D%20_model.predict(days)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20_records.append(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22SettlementRod%22%3A%20_model.series.series.object_id%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22HydrodynamicPeriod%22%3A%20_model.model.hydrodynamicPeriod%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22PrimarySettlement%22%3A%20_model.model.primarySettlement%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Shift%22%3A%20_model.model.shift%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22FinalSettlement%22%3A%20_model.model.finalSettlement%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20_df_left%20%3D%20pd.DataFrame(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22days%22%3A%20_model.series.days%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22fill_thicknesses%22%3A%20_model.series.fill_thicknesses%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22settlements%22%3A%20np.array(_model.series.settlements)%20*%20-1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22merge%22%3A%20(np.round(_model.series.days%2C%203)%20*%20100).astype(int)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20_df_right%20%3D%20pd.DataFrame(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22days%22%3A%20days%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22predict%22%3A%20np.array(result.settlement)%20*%20-1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22merge%22%3A%20(np.round(days%2C%203)%20*%20100).astype(int)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20_df%20%3D%20pd.merge(_df_right%2C%20_df_left%2C%20on%3D%22merge%22%2C%20how%3D%22left%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20_df%5B%22days_merge%22%5D%20%3D%20(_df%5B%22merge%22%5D%20%2F%20100).astype(int)%0A%20%20%20%20%20%20%20%20%20%20%20%20_df%5B%22date_time%22%5D%20%3D%20pd.to_datetime(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20datetime.timedelta(days%3Ddays)%20%2B%20start_date_time.value%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20days%20in%20_df%5B%22days_merge%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20errors%3D%22coerce%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20_df%20%3D%20_df.interpolate(limit_direction%3D%22backward%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20_df%5B%22object_id%22%5D%20%3D%20_model.series.series.object_id%0A%20%20%20%20%20%20%20%20%20%20%20%20prediction_db_list.append(_df)%0A%20%20%20%20%20%20%20%20except%20ValueError%20as%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22%3Awarning%3A%20%7Bmeasurement.object_id%7D%20provided%20the%20following%20error%3A%20%7Be%7D%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20prediction_db%20%3D%20pd.concat(prediction_db_list)%0A%20%20%20%20prediction_df%20%3D%20pd.DataFrame(_records)%0A%20%20%20%20return%20prediction_db%2C%20prediction_df%0A%0A%0A%40app.cell%0Adef%20_(prediction_df)%3A%0A%20%20%20%20prediction_df.round(2)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(alt%2C%20mo%2C%20model_list%2C%20prediction_db)%3A%0A%20%20%20%20mo.stop(predicate%3Dlen(model_list)%20%3D%3D%200)%0A%0A%20%20%20%20_chart_1%20%3D%20(%0A%20%20%20%20%20%20%20%20alt.Chart(prediction_db)%0A%20%20%20%20%20%20%20%20.mark_line()%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3Dalt.X(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20field%3D%22days_merge%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20type%3D%22quantitative%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3D%22Days%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20scale%3Dalt.Scale(type%3D%22symlog%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y%3Dalt.Y(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20field%3D%22fill_thicknesses%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20type%3D%22quantitative%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3D%22Measurements%20%5Bm%5D%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3Dalt.Color(field%3D%22object_id%22%2C%20type%3D%22nominal%22%2C%20title%3D%22Legend%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tooltip%3D%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20field%3D%22date_time%22%2C%20timeUnit%3D%22yearmonthdate%22%2C%20title%3D%22Date%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20field%3D%22fill_thicknesses%22%2C%20format%3D%22%2C.2f%22%2C%20title%3D%22Value%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(field%3D%22object_id%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20)%0A%0A%20%20%20%20(_chart_1).resolve_scale()%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(alt%2C%20mo%2C%20model_list%2C%20prediction_db)%3A%0A%20%20%20%20mo.stop(predicate%3Dlen(model_list)%20%3D%3D%200)%0A%20%20%20%20_colors%20%3D%20alt.Scale(%0A%20%20%20%20%20%20%20%20domain%3D%5B%22settlements%22%2C%20%22predict%22%5D%2C%20range%3D%5B%22orange%22%2C%20%22green%22%5D%0A%20%20%20%20)%0A%0A%20%20%20%20_chart_1%20%3D%20(%0A%20%20%20%20%20%20%20%20alt.Chart(prediction_db)%0A%20%20%20%20%20%20%20%20.mark_line()%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3Dalt.X(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20field%3D%22days_merge%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20type%3D%22quantitative%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3D%22Days%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20scale%3Dalt.Scale(type%3D%22symlog%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y%3Dalt.Y(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20field%3D%22predict%22%2C%20type%3D%22quantitative%22%2C%20title%3D%22Measurements%20%5Bm%5D%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3Dalt.Color(field%3D%22object_id%22%2C%20type%3D%22nominal%22%2C%20title%3D%22Legend%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tooltip%3D%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20field%3D%22date_time%22%2C%20timeUnit%3D%22yearmonthdate%22%2C%20title%3D%22Date%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(field%3D%22predict%22%2C%20format%3D%22%2C.2f%22%2C%20title%3D%22Value%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(field%3D%22object_id%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20)%0A%20%20%20%20_chart_2%20%3D%20(%0A%20%20%20%20%20%20%20%20alt.Chart(prediction_db)%0A%20%20%20%20%20%20%20%20.mark_line()%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3Dalt.X(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20field%3D%22days_merge%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20type%3D%22quantitative%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3D%22Days%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20scale%3Dalt.Scale(type%3D%22symlog%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y%3Dalt.Y(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20field%3D%22settlements%22%2C%20type%3D%22quantitative%22%2C%20title%3D%22Measurements%20%5Bm%5D%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3Dalt.Color(field%3D%22object_id%22%2C%20type%3D%22nominal%22%2C%20title%3D%22Legend%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tooltip%3D%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20field%3D%22date_time%22%2C%20timeUnit%3D%22yearmonthdate%22%2C%20title%3D%22Date%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(field%3D%22settlements%22%2C%20format%3D%22%2C.2f%22%2C%20title%3D%22Value%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(field%3D%22object_id%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20)%0A%0A%20%20%20%20(_chart_1%20%2B%20_chart_2).resolve_scale()%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20model_list%2C%20prediction_db)%3A%0A%20%20%20%20mo.stop(predicate%3Dlen(model_list)%20%3D%3D%200)%0A%20%20%20%20csv_download_lazy_prediction%20%3D%20mo.download(%0A%20%20%20%20%20%20%20%20data%3Dprediction_db.to_csv(sep%3D%22%3B%22).encode(%22utf-8%22)%2C%0A%20%20%20%20%20%20%20%20filename%3D%22measurements.csv%22%2C%0A%20%20%20%20%20%20%20%20mimetype%3D%22text%2Fcsv%22%2C%0A%20%20%20%20%20%20%20%20label%3D%22Download%20CSV%22%2C%0A%20%20%20%20)%0A%20%20%20%20csv_download_lazy_prediction%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A</marimo-code></head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "notebook.py",
            "mode": "read",
            "version": "0.14.17",
            "serverToken": "unused",
            "config": {"completion": {"activate_on_typing": true, "copilot": false}, "display": {"cell_output": "above", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": false, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": true}}, "package_management": {"manager": "pip"}, "runtime": {"auto_instantiate": true, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "off", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"app_title": "BAEC", "layout_file": "data:application/json;base64,ewogICJ0eXBlIjogImdyaWQiLAogICJkYXRhIjogewogICAgImNvbHVtbnMiOiAyNCwKICAgICJyb3dIZWlnaHQiOiAyMCwKICAgICJtYXhXaWR0aCI6IDE0MDAsCiAgICAiYm9yZGVyZWQiOiB0cnVlLAogICAgImNlbGxzIjogWwogICAgICB7CiAgICAgICAgInBvc2l0aW9uIjogbnVsbAogICAgICB9LAogICAgICB7CiAgICAgICAgInBvc2l0aW9uIjogbnVsbAogICAgICB9LAogICAgICB7CiAgICAgICAgInBvc2l0aW9uIjogWwogICAgICAgICAgMSwKICAgICAgICAgIDEsCiAgICAgICAgICA4LAogICAgICAgICAgMwogICAgICAgIF0KICAgICAgfSwKICAgICAgewogICAgICAgICJwb3NpdGlvbiI6IG51bGwKICAgICAgfSwKICAgICAgewogICAgICAgICJwb3NpdGlvbiI6IFsKICAgICAgICAgIDE1LAogICAgICAgICAgMSwKICAgICAgICAgIDcsCiAgICAgICAgICAzCiAgICAgICAgXQogICAgICB9LAogICAgICB7CiAgICAgICAgInBvc2l0aW9uIjogWwogICAgICAgICAgMTQsCiAgICAgICAgICA1LAogICAgICAgICAgOSwKICAgICAgICAgIDMKICAgICAgICBdCiAgICAgIH0sCiAgICAgIHsKICAgICAgICAicG9zaXRpb24iOiBudWxsCiAgICAgIH0sCiAgICAgIHsKICAgICAgICAicG9zaXRpb24iOiBudWxsCiAgICAgIH0sCiAgICAgIHsKICAgICAgICAicG9zaXRpb24iOiBbCiAgICAgICAgICAxLAogICAgICAgICAgOSwKICAgICAgICAgIDcsCiAgICAgICAgICAzCiAgICAgICAgXQogICAgICB9LAogICAgICB7CiAgICAgICAgInBvc2l0aW9uIjogWwogICAgICAgICAgOSwKICAgICAgICAgIDksCiAgICAgICAgICA3LAogICAgICAgICAgMwogICAgICAgIF0sCiAgICAgICAgInNpZGUiOiAibGVmdCIKICAgICAgfSwKICAgICAgewogICAgICAgICJwb3NpdGlvbiI6IG51bGwKICAgICAgfSwKICAgICAgewogICAgICAgICJwb3NpdGlvbiI6IG51bGwKICAgICAgfSwKICAgICAgewogICAgICAgICJwb3NpdGlvbiI6IFsKICAgICAgICAgIDEsCiAgICAgICAgICAxMiwKICAgICAgICAgIDIyLAogICAgICAgICAgMzAKICAgICAgICBdCiAgICAgIH0sCiAgICAgIHsKICAgICAgICAicG9zaXRpb24iOiBbCiAgICAgICAgICAxNywKICAgICAgICAgIDksCiAgICAgICAgICA2LAogICAgICAgICAgMwogICAgICAgIF0sCiAgICAgICAgInNpZGUiOiAibGVmdCIKICAgICAgfSwKICAgICAgewogICAgICAgICJwb3NpdGlvbiI6IFsKICAgICAgICAgIDEsCiAgICAgICAgICA0MiwKICAgICAgICAgIDIyLAogICAgICAgICAgMTkKICAgICAgICBdCiAgICAgIH0sCiAgICAgIHsKICAgICAgICAicG9zaXRpb24iOiBbCiAgICAgICAgICAxLAogICAgICAgICAgNjEsCiAgICAgICAgICAyMiwKICAgICAgICAgIDE4CiAgICAgICAgXQogICAgICB9LAogICAgICB7CiAgICAgICAgInBvc2l0aW9uIjogWwogICAgICAgICAgMTcsCiAgICAgICAgICA3OSwKICAgICAgICAgIDYsCiAgICAgICAgICAzCiAgICAgICAgXSwKICAgICAgICAic2lkZSI6ICJyaWdodCIKICAgICAgfSwKICAgICAgewogICAgICAgICJwb3NpdGlvbiI6IG51bGwKICAgICAgfSwKICAgICAgewogICAgICAgICJwb3NpdGlvbiI6IFsKICAgICAgICAgIDEsCiAgICAgICAgICA3OSwKICAgICAgICAgIDcsCiAgICAgICAgICAzCiAgICAgICAgXQogICAgICB9LAogICAgICB7CiAgICAgICAgInBvc2l0aW9uIjogWwogICAgICAgICAgMSwKICAgICAgICAgIDgyLAogICAgICAgICAgNywKICAgICAgICAgIDMKICAgICAgICBdCiAgICAgIH0sCiAgICAgIHsKICAgICAgICAicG9zaXRpb24iOiBbCiAgICAgICAgICAxLAogICAgICAgICAgODgsCiAgICAgICAgICA3LAogICAgICAgICAgMwogICAgICAgIF0KICAgICAgfSwKICAgICAgewogICAgICAgICJwb3NpdGlvbiI6IFsKICAgICAgICAgIDEsCiAgICAgICAgICA4NSwKICAgICAgICAgIDcsCiAgICAgICAgICAzCiAgICAgICAgXQogICAgICB9LAogICAgICB7CiAgICAgICAgInBvc2l0aW9uIjogbnVsbAogICAgICB9LAogICAgICB7CiAgICAgICAgInBvc2l0aW9uIjogbnVsbAogICAgICB9LAogICAgICB7CiAgICAgICAgInBvc2l0aW9uIjogWwogICAgICAgICAgMSwKICAgICAgICAgIDkxLAogICAgICAgICAgMjIsCiAgICAgICAgICAxMwogICAgICAgIF0KICAgICAgfSwKICAgICAgewogICAgICAgICJwb3NpdGlvbiI6IG51bGwKICAgICAgfSwKICAgICAgewogICAgICAgICJwb3NpdGlvbiI6IFsKICAgICAgICAgIDEsCiAgICAgICAgICAxMDQsCiAgICAgICAgICAyMiwKICAgICAgICAgIDIzCiAgICAgICAgXQogICAgICB9LAogICAgICB7CiAgICAgICAgInBvc2l0aW9uIjogbnVsbAogICAgICB9CiAgICBdCiAgfQp9", "sql_output": "auto", "width": "medium"},
            "view": {"showAppCode": false},
            "notebook": null,
            "session": null,
            "runtimeConfig": null,
        };
    </script>
  </body>
</html>
